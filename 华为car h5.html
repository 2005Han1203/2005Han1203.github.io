<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>华为智能汽车·星途驾驶舱</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.3.3/aframe/build/aframe.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        .loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff; font-size: 18px; text-align: center; }
        .control-panel { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; }
        .btn { padding: 10px 20px; background: #007aff; color: #fff; border: none; border-radius: 30px; font-size: 14px; cursor: pointer; }
    </style>
</head>
<body>
    <a-scene arjs="trackingMethod: best; sourceType: camera; detectionMode: mono_and_matrix; matrixCodeType: 3x3;" vr-mode-ui="enabled: false">
        <!-- 华为汽车风格3D模型（免费商用） -->
        <a-entity 
            gltf-model="https://cdn.jsdelivr.net/gh/aleeper/three.js-examples/models/gltf/Car/Car.gltf"
            scale="1.5 1.5 1.5" 
            position="0 0 -2"
        ></a-entity>
        <a-entity camera look-controls></a-entity>
    </a-scene>

    <div class="loading">授权相机后，扫描地面生成虚拟汽车...</div>
    <div class="control-panel" style="display: none;">
        <button class="btn" id="startDemo">智能驾驶演示</button>
        <button class="btn" id="shareReport">领优惠券</button>
    </div>

    <script>
        // 修复iOS/Android相机权限触发问题
        document.addEventListener('DOMContentLoaded', () => {
            const requestBtn = document.createElement('button');
            requestBtn.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:15px 30px;font-size:16px;background:#007aff;color:#fff;border:none;border-radius:30px;z-index:9999;';
            requestBtn.textContent = '点击启动AR试驾';
            document.body.appendChild(requestBtn);

            requestBtn.addEventListener('click', () => {
                requestBtn.remove();
                document.querySelector('a-scene').play();
            });
        });

        // 模型加载完成后显示控制按钮
        document.querySelector('a-entity[gltf-model]').addEventListener('loaded', () => {
            document.querySelector('.loading').style.display = 'none';
            document.querySelector('.control-panel').style.display = 'flex';
        });

        // 演示功能
        document.getElementById('startDemo').addEventListener('click', () => {
            alert('智能驾驶功能启动！已模拟自动泊车、语音控制～');
        });

        // 分享领券
        document.getElementById('shareReport').addEventListener('click', () => {
            alert('分享成功！已为你解锁1000元购车优惠券，联系客服领取～');
        });

        // 重力感应视角控制
        window.addEventListener('deviceorientation', (e) => {
            const camera = document.querySelector('a-entity[camera]');
            const x = (e.beta || 0) / 90 * 0.2;
            const y = (e.gamma || 0) / 90 * 0.2;
            camera.setAttribute('rotation', `${x} ${y} 0`);
        });
    </script>
</body>
</html>